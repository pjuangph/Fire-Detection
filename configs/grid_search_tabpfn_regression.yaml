# Grid search configuration for TabPFN regression fire detection training.
#
# Usage:
#   python train_tabpfn_regression.py --config configs/grid_search_tabpfn_regression.yaml
#
# TabPFN is initialized with random weights (model_path="random:<seed>")
# and trained with gradient descent using bar distribution regression loss
# (CRPS + optional MSE auxiliary).
#
# Grid size: 2 x 1 x 2 x 2 x 2 x 1 x 2 = 32 total runs.

epochs: 20
metric: error_rate          # minimize (FN+FP)/P on test set
seed: 0
save_every: 5               # save checkpoint every N epochs for crash recovery

search_space:
  learning_rate: [3.0e-4, 1.0e-4]
  batch_size: [4096]
  n_estimators: [1, 2]
  weight_decay: [0.01, 0.001]
  grad_clip_norm: [0.5, 1.0]
  # Regression loss weights (passed to _compute_regression_loss)
  crps_loss_weight: [1.0]
  mse_loss_weight: [0.0, 1.0]
